2023-07-13 16:42:40 - INFO: dict_items([('dataset', 'loc'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 96), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 288), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 8), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'bert-base-chinese'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/loc.json'), ('device', 0)])
2023-07-13 16:42:40 - INFO: Loading Data
2023-07-13 16:42:45 - INFO: 
+-------+-----------+----------+
|  loc  | sentences | entities |
+-------+-----------+----------+
| train |    800    |   2066   |
|  dev  |    148    |   390    |
|  test |    148    |   390    |
+-------+-----------+----------+
2023-07-13 16:42:47 - INFO: Building Model
2023-07-13 16:42:54 - INFO: Epoch: 0
2023-07-13 16:43:05 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.3857 | 0.2312 |   0.2473  | 0.2293 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:43:06 - INFO: EVAL Label F1 [0.9969965  0.9899322  0.6015625  0.35379061]
2023-07-13 16:43:06 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7356 |   0.7100  | 0.7792 |
| Entity | 0.4492 |   0.7368  | 0.3231 |
+--------+--------+-----------+--------+
2023-07-13 16:43:07 - INFO: TEST Label F1 [0.9969965  0.9899322  0.6015625  0.35379061]
2023-07-13 16:43:07 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7356 |   0.7100  | 0.7792 |
| Entity | 0.4492 |   0.7368  | 0.3231 |
+--------+--------+-----------+--------+
2023-07-13 16:43:08 - INFO: Epoch: 1
2023-07-13 16:43:20 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0118 | 0.8345 |   0.8767  | 0.8013 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:43:21 - INFO: EVAL Label F1 [0.99968506 0.99833956 0.92890995 0.95470383]
2023-07-13 16:43:21 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9704 |   0.9594  | 0.9839 |
| Entity | 0.7253 |   0.9352  | 0.5923 |
+--------+--------+-----------+--------+
2023-07-13 16:43:22 - INFO: TEST Label F1 [0.99968506 0.99833956 0.92890995 0.95470383]
2023-07-13 16:43:22 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9704 |   0.9594  | 0.9839 |
| Entity | 0.7253 |   0.9352  | 0.5923 |
+--------+--------+-----------+--------+
2023-07-13 16:43:23 - INFO: Epoch: 2
2023-07-13 16:43:34 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0049 | 0.9521 |   0.9586  | 0.9458 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:43:35 - INFO: EVAL Label F1 [0.99976844 0.99896244 0.95098039 0.96527778]
2023-07-13 16:43:35 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9787 |   0.9733  | 0.9850 |
| Entity | 0.7378 |   0.9514  | 0.6026 |
+--------+--------+-----------+--------+
2023-07-13 16:43:36 - INFO: TEST Label F1 [0.99976844 0.99896244 0.95098039 0.96527778]
2023-07-13 16:43:36 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9787 |   0.9733  | 0.9850 |
| Entity | 0.7378 |   0.9514  | 0.6026 |
+--------+--------+-----------+--------+
2023-07-13 16:43:37 - INFO: Epoch: 3
2023-07-13 16:43:48 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0028 | 0.9703 |   0.9743  | 0.9664 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:43:49 - INFO: EVAL Label F1 [0.99975916 0.99875415 0.93333333 0.97945205]
2023-07-13 16:43:49 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9778 |   0.9636  | 0.9942 |
| Entity | 0.7383 |   0.9405  | 0.6077 |
+--------+--------+-----------+--------+
2023-07-13 16:43:50 - INFO: TEST Label F1 [0.99975916 0.99875415 0.93333333 0.97945205]
2023-07-13 16:43:50 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9778 |   0.9636  | 0.9942 |
| Entity | 0.7383 |   0.9405  | 0.6077 |
+--------+--------+-----------+--------+
2023-07-13 16:43:51 - INFO: Epoch: 4
2023-07-13 16:44:02 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0023 | 0.9779 |   0.9786  | 0.9772 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:44:03 - INFO: EVAL Label F1 [0.99984254 0.99896244 0.97029703 0.97945205]
2023-07-13 16:44:03 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9871 |   0.9803  | 0.9944 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:44:04 - INFO: TEST Label F1 [0.99984254 0.99896244 0.97029703 0.97945205]
2023-07-13 16:44:04 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9871 |   0.9803  | 0.9944 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:44:05 - INFO: Epoch: 5
2023-07-13 16:44:17 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0018 | 0.9830 |   0.9829  | 0.9830 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:44:17 - INFO: EVAL Label F1 [0.99988885 0.99916978 0.97979798 0.98630137]
2023-07-13 16:44:17 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9913 |   0.9890  | 0.9936 |
| Entity | 0.7551 |   0.9835  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:44:18 - INFO: TEST Label F1 [0.99988885 0.99916978 0.97979798 0.98630137]
2023-07-13 16:44:18 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9913 |   0.9890  | 0.9936 |
| Entity | 0.7551 |   0.9835  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:44:20 - INFO: Epoch: 6
2023-07-13 16:44:31 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0011 | 0.9891 |   0.9881  | 0.9900 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:44:32 - INFO: EVAL Label F1 [0.9998518  0.99896244 0.96482412 0.98630137]
2023-07-13 16:44:32 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9875 |   0.9841  | 0.9910 |
| Entity | 0.7496 |   0.9714  | 0.6103 |
+--------+--------+-----------+--------+
2023-07-13 16:44:32 - INFO: TEST Label F1 [0.9998518  0.99896244 0.96482412 0.98630137]
2023-07-13 16:44:32 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9875 |   0.9841  | 0.9910 |
| Entity | 0.7496 |   0.9714  | 0.6103 |
+--------+--------+-----------+--------+
2023-07-13 16:44:32 - INFO: Epoch: 7
2023-07-13 16:44:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0011 | 0.9878 |   0.9893  | 0.9863 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:44:44 - INFO: EVAL Label F1 [0.99987032 0.99917012 0.97029703 0.98630137]
2023-07-13 16:44:44 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9889 |   0.9820  | 0.9962 |
| Entity | 0.7543 |   0.9679  | 0.6179 |
+--------+--------+-----------+--------+
2023-07-13 16:44:45 - INFO: TEST Label F1 [0.99987032 0.99917012 0.97029703 0.98630137]
2023-07-13 16:44:45 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9889 |   0.9820  | 0.9962 |
| Entity | 0.7543 |   0.9679  | 0.6179 |
+--------+--------+-----------+--------+
2023-07-13 16:44:45 - INFO: Epoch: 8
2023-07-13 16:44:56 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0011 | 0.9915 |   0.9914  | 0.9915 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:44:57 - INFO: EVAL Label F1 [0.99990738 0.99937772 0.98477157 0.98630137]
2023-07-13 16:44:57 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9926 |   0.9914  | 0.9938 |
| Entity | 0.7591 |   0.9837  | 0.6179 |
+--------+--------+-----------+--------+
2023-07-13 16:44:58 - INFO: TEST Label F1 [0.99990738 0.99937772 0.98477157 0.98630137]
2023-07-13 16:44:58 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9926 |   0.9914  | 0.9938 |
| Entity | 0.7591 |   0.9837  | 0.6179 |
+--------+--------+-----------+--------+
2023-07-13 16:45:00 - INFO: Epoch: 9
2023-07-13 16:45:11 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0010 | 0.9875 |   0.9900  | 0.9851 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:45:12 - INFO: EVAL Label F1 [0.99986106 0.99896244 0.97487437 0.98293515]
2023-07-13 16:45:12 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9892 |   0.9849  | 0.9936 |
| Entity | 0.7516 |   0.9715  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:45:12 - INFO: TEST Label F1 [0.99986106 0.99896244 0.97487437 0.98293515]
2023-07-13 16:45:12 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9892 |   0.9849  | 0.9936 |
| Entity | 0.7516 |   0.9715  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:45:12 - INFO: Best DEV F1: 0.7591
2023-07-13 16:45:12 - INFO: Best TEST F1: 0.7591
2023-07-13 16:45:14 - INFO: TEST Label F1 [0.99990738 0.99937772 0.98477157 0.98630137]
2023-07-13 16:45:14 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9926 |   0.9914  | 0.9938 |
|   Entity   | 0.7591 |   0.9837  | 0.6179 |
+------------+--------+-----------+--------+

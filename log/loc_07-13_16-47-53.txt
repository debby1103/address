2023-07-13 16:47:53 - INFO: dict_items([('dataset', 'loc'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 96), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 288), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 24), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'bert-base-chinese'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/loc.json'), ('device', 0)])
2023-07-13 16:47:53 - INFO: Loading Data
2023-07-13 16:47:57 - INFO: 
+-------+-----------+----------+
|  loc  | sentences | entities |
+-------+-----------+----------+
| train |    800    |   2066   |
|  dev  |    148    |   390    |
|  test |    148    |   390    |
+-------+-----------+----------+
2023-07-13 16:47:59 - INFO: Building Model
2023-07-13 16:48:06 - INFO: Epoch: 0
2023-07-13 16:48:11 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.5876 | 0.1975 |   0.1980  | 0.1971 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:11 - INFO: EVAL Label F1 [0.9759987 0.        0.        0.       ]
2023-07-13 16:48:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.2440 |   0.2383  | 0.2500 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 16:48:12 - INFO: TEST Label F1 [0.9759987 0.        0.        0.       ]
2023-07-13 16:48:12 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.2440 |   0.2383  | 0.2500 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 16:48:12 - INFO: Epoch: 1
2023-07-13 16:48:16 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.1516 | 0.3187 |   0.4778  | 0.2938 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:17 - INFO: EVAL Label F1 [0.99683667 0.98006509 0.         0.        ]
2023-07-13 16:48:17 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.4942 |   0.4893  | 0.4993 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 16:48:17 - INFO: TEST Label F1 [0.99683667 0.98006509 0.         0.        ]
2023-07-13 16:48:17 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.4942 |   0.4893  | 0.4993 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 16:48:17 - INFO: Epoch: 2
2023-07-13 16:48:22 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0242 | 0.6403 |   0.7643  | 0.5938 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:22 - INFO: EVAL Label F1 [0.99750475 0.99354032 0.64383562 0.63492063]
2023-07-13 16:48:22 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8175 |   0.7498  | 0.9415 |
| Entity | 0.6264 |   0.8610  | 0.4923 |
+--------+--------+-----------+--------+
2023-07-13 16:48:23 - INFO: TEST Label F1 [0.99750475 0.99354032 0.64383562 0.63492063]
2023-07-13 16:48:23 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8175 |   0.7498  | 0.9415 |
| Entity | 0.6264 |   0.8610  | 0.4923 |
+--------+--------+-----------+--------+
2023-07-13 16:48:24 - INFO: Epoch: 3
2023-07-13 16:48:29 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0110 | 0.8183 |   0.8638  | 0.7851 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:29 - INFO: EVAL Label F1 [0.99919384 0.99813084 0.94117647 0.80357143]
2023-07-13 16:48:29 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9355 |   0.9038  | 0.9749 |
| Entity | 0.6966 |   0.8789  | 0.5769 |
+--------+--------+-----------+--------+
2023-07-13 16:48:30 - INFO: TEST Label F1 [0.99919384 0.99813084 0.94117647 0.80357143]
2023-07-13 16:48:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9355 |   0.9038  | 0.9749 |
| Entity | 0.6966 |   0.8789  | 0.5769 |
+--------+--------+-----------+--------+
2023-07-13 16:48:31 - INFO: Epoch: 4
2023-07-13 16:48:36 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0077 | 0.8976 |   0.9192  | 0.8792 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:36 - INFO: EVAL Label F1 [0.99963881 0.99813084 0.95049505 0.92907801]
2023-07-13 16:48:36 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9693 |   0.9714  | 0.9683 |
| Entity | 0.7191 |   0.9614  | 0.5744 |
+--------+--------+-----------+--------+
2023-07-13 16:48:37 - INFO: TEST Label F1 [0.99963881 0.99813084 0.95049505 0.92907801]
2023-07-13 16:48:37 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9693 |   0.9714  | 0.9683 |
| Entity | 0.7191 |   0.9614  | 0.5744 |
+--------+--------+-----------+--------+
2023-07-13 16:48:38 - INFO: Epoch: 5
2023-07-13 16:48:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0048 | 0.9414 |   0.9564  | 0.9278 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:44 - INFO: EVAL Label F1 [0.99976843 0.99854621 0.95566502 0.96949153]
2023-07-13 16:48:44 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9809 |   0.9708  | 0.9915 |
| Entity | 0.7433 |   0.9633  | 0.6051 |
+--------+--------+-----------+--------+
2023-07-13 16:48:44 - INFO: TEST Label F1 [0.99976843 0.99854621 0.95566502 0.96949153]
2023-07-13 16:48:44 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9809 |   0.9708  | 0.9915 |
| Entity | 0.7433 |   0.9633  | 0.6051 |
+--------+--------+-----------+--------+
2023-07-13 16:48:46 - INFO: Epoch: 6
2023-07-13 16:48:50 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0040 | 0.9541 |   0.9651  | 0.9436 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:50 - INFO: EVAL Label F1 [0.99980548 0.99875415 0.96078431 0.97627119]
2023-07-13 16:48:50 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9839 |   0.9727  | 0.9959 |
| Entity | 0.7461 |   0.9597  | 0.6103 |
+--------+--------+-----------+--------+
2023-07-13 16:48:51 - INFO: TEST Label F1 [0.99980548 0.99875415 0.96078431 0.97627119]
2023-07-13 16:48:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9839 |   0.9727  | 0.9959 |
| Entity | 0.7461 |   0.9597  | 0.6103 |
+--------+--------+-----------+--------+
2023-07-13 16:48:53 - INFO: Epoch: 7
2023-07-13 16:48:57 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0035 | 0.9590 |   0.9639  | 0.9545 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:48:58 - INFO: EVAL Label F1 [0.99980548 0.99896201 0.96551724 0.96969697]
2023-07-13 16:48:58 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9835 |   0.9717  | 0.9960 |
| Entity | 0.7480 |   0.9598  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:48:58 - INFO: TEST Label F1 [0.99980548 0.99896201 0.96551724 0.96969697]
2023-07-13 16:48:58 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9835 |   0.9717  | 0.9960 |
| Entity | 0.7480 |   0.9598  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:49:00 - INFO: Epoch: 8
2023-07-13 16:49:04 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0026 | 0.9697 |   0.9738  | 0.9658 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:49:05 - INFO: EVAL Label F1 [0.99982401 0.99896201 0.96551724 0.97627119]
2023-07-13 16:49:05 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9851 |   0.9749  | 0.9960 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:49:05 - INFO: TEST Label F1 [0.99982401 0.99896201 0.96551724 0.97627119]
2023-07-13 16:49:05 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9851 |   0.9749  | 0.9960 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:49:07 - INFO: Epoch: 9
2023-07-13 16:49:11 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0029 | 0.9675 |   0.9732  | 0.9619 |
+---------+--------+--------+-----------+--------+
2023-07-13 16:49:12 - INFO: EVAL Label F1 [0.99982401 0.99896201 0.96551724 0.97627119]
2023-07-13 16:49:12 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9851 |   0.9749  | 0.9960 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:49:12 - INFO: TEST Label F1 [0.99982401 0.99896201 0.96551724 0.97627119]
2023-07-13 16:49:12 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9851 |   0.9749  | 0.9960 |
| Entity | 0.7492 |   0.9637  | 0.6128 |
+--------+--------+-----------+--------+
2023-07-13 16:49:12 - INFO: Best DEV F1: 0.7492
2023-07-13 16:49:12 - INFO: Best TEST F1: 0.7492
2023-07-13 16:49:13 - INFO: TEST Label F1 [0.99982401 0.99896201 0.96551724 0.97627119]
2023-07-13 16:49:13 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9851 |   0.9749  | 0.9960 |
|   Entity   | 0.7492 |   0.9637  | 0.6128 |
+------------+--------+-----------+--------+

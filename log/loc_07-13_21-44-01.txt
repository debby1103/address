2023-07-13 21:44:01 - INFO: dict_items([('dataset', 'loc'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 96), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 288), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 24), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'bert-base-chinese'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/loc.json'), ('device', 0)])
2023-07-13 21:44:02 - INFO: Loading Data
2023-07-13 21:44:06 - INFO: 
+-------+-----------+----------+
|  loc  | sentences | entities |
+-------+-----------+----------+
| train |    800    |   1745   |
|  dev  |    148    |   345    |
|  test |    148    |   345    |
+-------+-----------+----------+
2023-07-13 21:44:08 - INFO: Building Model
2023-07-13 21:44:15 - INFO: Epoch: 0
2023-07-13 21:44:20 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.6054 | 0.1945 |   0.2031  | 0.2008 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:21 - INFO: EVAL Label F1 [0.9759987 0.        0.        0.        0.       ]
2023-07-13 21:44:21 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.1952 |   0.1906  | 0.2000 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 21:44:22 - INFO: TEST Label F1 [0.9759987 0.        0.        0.        0.       ]
2023-07-13 21:44:22 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.1952 |   0.1906  | 0.2000 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 21:44:22 - INFO: Epoch: 1
2023-07-13 21:44:26 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.1577 | 0.2617 |   0.3794  | 0.2400 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:27 - INFO: EVAL Label F1 [0.99497209 0.95795479 0.         0.         0.        ]
2023-07-13 21:44:27 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.3906 |   0.3857  | 0.3957 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 21:44:28 - INFO: TEST Label F1 [0.99497209 0.95795479 0.         0.         0.        ]
2023-07-13 21:44:28 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.3906 |   0.3857  | 0.3957 |
| Entity | 0.0000 |   0.0000  | 0.0000 |
+--------+--------+-----------+--------+
2023-07-13 21:44:28 - INFO: Epoch: 2
2023-07-13 21:44:32 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0437 | 0.4290 |   0.5618  | 0.4156 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:33 - INFO: EVAL Label F1 [0.99522923 0.97942387 0.55357143 0.26086957 0.        ]
2023-07-13 21:44:33 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.5578 |   0.5349  | 0.6298 |
| Entity | 0.4938 |   0.8511  | 0.3478 |
+--------+--------+-----------+--------+
2023-07-13 21:44:34 - INFO: TEST Label F1 [0.99522923 0.97942387 0.55357143 0.26086957 0.        ]
2023-07-13 21:44:34 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.5578 |   0.5349  | 0.6298 |
| Entity | 0.4938 |   0.8511  | 0.3478 |
+--------+--------+-----------+--------+
2023-07-13 21:44:35 - INFO: Epoch: 3
2023-07-13 21:44:40 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0257 | 0.5876 |   0.7140  | 0.5591 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:41 - INFO: EVAL Label F1 [0.99788004 0.99089332 0.91457286 0.55462185 0.66666667]
2023-07-13 21:44:41 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8249 |   0.8537  | 0.8083 |
| Entity | 0.7150 |   0.8282  | 0.6290 |
+--------+--------+-----------+--------+
2023-07-13 21:44:41 - INFO: TEST Label F1 [0.99788004 0.99089332 0.91457286 0.55462185 0.66666667]
2023-07-13 21:44:41 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8249 |   0.8537  | 0.8083 |
| Entity | 0.7150 |   0.8282  | 0.6290 |
+--------+--------+-----------+--------+
2023-07-13 21:44:43 - INFO: Epoch: 4
2023-07-13 21:44:47 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0169 | 0.7467 |   0.8399  | 0.6955 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:48 - INFO: EVAL Label F1 [0.99841504 0.99327403 0.91509434 0.74777448 0.83700441]
2023-07-13 21:44:48 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8983 |   0.8519  | 0.9564 |
| Entity | 0.8508 |   0.8127  | 0.8928 |
+--------+--------+-----------+--------+
2023-07-13 21:44:49 - INFO: TEST Label F1 [0.99841504 0.99327403 0.91509434 0.74777448 0.83700441]
2023-07-13 21:44:49 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8983 |   0.8519  | 0.9564 |
| Entity | 0.8508 |   0.8127  | 0.8928 |
+--------+--------+-----------+--------+
2023-07-13 21:44:51 - INFO: Epoch: 5
2023-07-13 21:44:55 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0123 | 0.8436 |   0.8891  | 0.8083 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:44:56 - INFO: EVAL Label F1 [0.99913866 0.99457583 0.91943128 0.86330935 0.93658537]
2023-07-13 21:44:56 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9426 |   0.9373  | 0.9507 |
| Entity | 0.9037 |   0.9242  | 0.8841 |
+--------+--------+-----------+--------+
2023-07-13 21:44:57 - INFO: TEST Label F1 [0.99913866 0.99457583 0.91943128 0.86330935 0.93658537]
2023-07-13 21:44:57 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9426 |   0.9373  | 0.9507 |
| Entity | 0.9037 |   0.9242  | 0.8841 |
+--------+--------+-----------+--------+
2023-07-13 21:44:58 - INFO: Epoch: 6
2023-07-13 21:45:03 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0103 | 0.8784 |   0.9173  | 0.8463 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:45:03 - INFO: EVAL Label F1 [0.99918479 0.99522984 0.93719807 0.86868687 0.93333333]
2023-07-13 21:45:03 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9467 |   0.9279  | 0.9672 |
| Entity | 0.9146 |   0.9133  | 0.9159 |
+--------+--------+-----------+--------+
2023-07-13 21:45:04 - INFO: TEST Label F1 [0.99918479 0.99522984 0.93719807 0.86868687 0.93333333]
2023-07-13 21:45:04 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9467 |   0.9279  | 0.9672 |
| Entity | 0.9146 |   0.9133  | 0.9159 |
+--------+--------+-----------+--------+
2023-07-13 21:45:05 - INFO: Epoch: 7
2023-07-13 21:45:09 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0091 | 0.9025 |   0.9240  | 0.8833 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:45:10 - INFO: EVAL Label F1 [0.99924039 0.9952319  0.93719807 0.88356164 0.93838863]
2023-07-13 21:45:10 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9507 |   0.9339  | 0.9693 |
| Entity | 0.9186 |   0.9213  | 0.9159 |
+--------+--------+-----------+--------+
2023-07-13 21:45:11 - INFO: TEST Label F1 [0.99924039 0.9952319  0.93719807 0.88356164 0.93838863]
2023-07-13 21:45:11 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9507 |   0.9339  | 0.9693 |
| Entity | 0.9186 |   0.9213  | 0.9159 |
+--------+--------+-----------+--------+
2023-07-13 21:45:13 - INFO: Epoch: 8
2023-07-13 21:45:17 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0082 | 0.9051 |   0.9299  | 0.8829 |
+---------+--------+--------+-----------+--------+
2023-07-13 21:45:18 - INFO: EVAL Label F1 [0.99924955 0.99652778 0.93333333 0.87947883 0.93457944]
2023-07-13 21:45:18 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9486 |   0.9194  | 0.9815 |
| Entity | 0.9202 |   0.9048  | 0.9362 |
+--------+--------+-----------+--------+
2023-07-13 21:45:19 - INFO: TEST Label F1 [0.99924955 0.99652778 0.93333333 0.87947883 0.93457944]
2023-07-13 21:45:19 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9486 |   0.9194  | 0.9815 |
| Entity | 0.9202 |   0.9048  | 0.9362 |
+--------+--------+-----------+--------+
2023-07-13 21:45:20 - INFO: Epoch: 9
